# AWI Project Tracker - Deployment Guide

## Prerequisites

1. **Digital Ocean Account**: Sign up at [digitalocean.com](https://digitalocean.com)
2. **GitHub Repository**: Push your code to GitHub
3. **MongoDB Atlas Account**: For MongoDB hosting (free tier available)
4. **API Keys**: Collect all required API keys

## Required API Keys and Services

### Essential Services
- **OpenAI API Key**: Get from [OpenAI Platform](https://platform.openai.com)
- **SendGrid API Key**: Get from [SendGrid](https://sendgrid.com)
- **MongoDB Atlas**: Get connection string from [MongoDB Atlas](https://www.mongodb.com/atlas)

### Environment Variables Template

Create these environment variables in Digital Ocean:

```
# Flask Configuration
FLASK_ENV=production
SECRET_KEY=your-super-secret-key-here
PYTHON_ENV=production

# Database Configuration (Auto-generated by Digital Ocean)
DATABASE_URL=postgresql://username:password@host:port/database_name

# OpenAI Configuration
OPENAI_API_KEY=your-openai-api-key

# SendGrid Configuration
SENDGRID_API_KEY=your-sendgrid-api-key
EMAIL_FROM=your-email@example.com

# MongoDB Configuration
MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/database_name

# Optional: Email Configuration (if using SMTP instead of SendGrid)
EMAIL_ADDRESS=your-email@example.com
EMAIL_PASSWORD=your-email-password
```

## Step-by-Step Deployment

### 1. Prepare Your Repository

1. **Push to GitHub**:
   ```bash
   git add .
   git commit -m "Prepare for deployment"
   git push origin main
   ```

2. **Update app.yaml**: Edit the `app.yaml` file and replace:
   - `YOUR_GITHUB_USERNAME` with your GitHub username
   - `YOUR_REPO_NAME` with your repository name

### 2. Set Up MongoDB Atlas

1. Go to [MongoDB Atlas](https://www.mongodb.com/atlas)
2. Create a free cluster
3. Create a database user
4. Whitelist IP addresses (use 0.0.0.0/0 for all IPs)
5. Get the connection string

### 3. Deploy on Digital Ocean App Platform

1. **Create New App**:
   - Go to [Digital Ocean App Platform](https://cloud.digitalocean.com/apps)
   - Click "Create App"
   - Choose "GitHub" as source
   - Select your repository

2. **Configure App**:
   - Use the provided `app.yaml` configuration
   - Or manually configure:
     - Runtime: Python
     - Build Command: `pip install -r requirements.txt`
     - Run Command: `gunicorn app:app --bind 0.0.0.0:$PORT --workers 4 --timeout 120`

3. **Add Database**:
   - In the app configuration, add a PostgreSQL database
   - Choose "Development" for testing or "Production" for live deployment

4. **Set Environment Variables**:
   Add all the environment variables from the template above

5. **Deploy**:
   - Click "Create Resources"
   - Wait for deployment to complete

### 4. Post-Deployment Setup

1. **Database Migration**:
   The app will automatically run database migrations via the Procfile

2. **Create Admin User**:
   The app will automatically create an admin user if none exists:
   - Username: `admin`
   - Password: `admin123`
   - **Important**: Change this password immediately after first login

3. **Upload Sample Images Directory**:
   Create the static directories for image uploads:
   - The app will handle this automatically

## Configuration Details

### Database Configuration
- **PostgreSQL**: Provided by Digital Ocean (automatic)
- **MongoDB**: External service (MongoDB Atlas)

### File Structure
```
static/
  sample_images/    # Auto-created for sample images
  uploads/          # Auto-created for file uploads
```

### Security Considerations

1. **Change Default Admin Password**: Immediately after deployment
2. **Use Strong Secret Key**: Generate a secure SECRET_KEY
3. **Restrict Database Access**: Use proper database credentials
4. **Enable HTTPS**: Digital Ocean provides this automatically

## Troubleshooting

### Common Issues

1. **Database Connection Error**:
   - Check DATABASE_URL format
   - Ensure database is running
   - Verify credentials

2. **MongoDB Connection Error**:
   - Check MONGODB_URI format
   - Verify IP whitelist includes 0.0.0.0/0
   - Ensure cluster is running

3. **OpenAI API Error**:
   - Verify API key is correct
   - Check OpenAI account has credits

4. **Email Service Error**:
   - Verify SendGrid API key
   - Check EMAIL_FROM address is verified in SendGrid

### Logs and Monitoring

- View logs in Digital Ocean App Platform dashboard
- Monitor application metrics
- Set up alerts for errors

## Scaling

### Horizontal Scaling
- Increase instance count in app.yaml
- Monitor resource usage

### Vertical Scaling
- Upgrade instance size (basic-xxs → basic-xs → basic-s)
- Consider database scaling

## Maintenance

### Updates
1. Push changes to GitHub
2. Digital Ocean will auto-deploy
3. Monitor deployment status

### Backups
- Database backups are automatic with Digital Ocean
- Consider MongoDB Atlas backup policies

## Cost Estimation

### Digital Ocean App Platform
- Basic plan: $5/month (basic-xxs instance)
- Database: $15/month (basic plan)
- Total: ~$20/month

### External Services
- MongoDB Atlas: Free tier (512MB)
- SendGrid: Free tier (100 emails/day)
- OpenAI: Pay per usage

## Support

- Digital Ocean Documentation: [docs.digitalocean.com](https://docs.digitalocean.com)
- App Platform Guides: [digitalocean.com/docs/app-platform](https://docs.digitalocean.com/products/app-platform/) 